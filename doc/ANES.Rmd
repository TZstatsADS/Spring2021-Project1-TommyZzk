---
title: "2016 American Presidential Election"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

# 1. Introduction
The *American National Election Studies* (ANES) are surveys of eligible voters  in the U.S. The ANEs conduct its two-wave pre and post study through face to face(FTF) and web interview. The data is collected and organized by Stanford University and the University of Michigan, with funding by the National Science Foundation. 

The data being used in this project is the *2016 Time Series Study*, which contains 1180 pre-election and 1,058 post-election face to face sample and 3,090 pre-election and 2,590 post-election internet sample. The aim of this Study data is to observe the electoral participation, voting behavior, public opinion, as well as media exposure, cognitive style, and values and predisposition. This project on the other hand will focus on the electoral participation, voting behavior, gender, race, location and etc.

A rule of thumb for analyzing any data set is to understand its study design and data collection process first. You are strongly encouraged to read the *codebooks*. 

# 3. Data processing for this R Notebook.
### Step 3.1 Checking `R` packages for data processing

From the packages' descriptions:

+ `tidyverse` is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures;
+ `haven` enables `R` to read and write various data formats used by other statistical packages. `haven` is part of the `tidyverse`.
+ `devtools` provides a collection of package development tools.
+ `RColorBrewer` provides ready-to-use color palettes.
+ `DT` provides an R interface to the JavaScript library DataTables;
+ `ggplot2` a collection of functions for creating graphics, based on The Grammar of Graphics.

```{r load libraries, warning=FALSE, message=FALSE, include=FALSE}
library(ggplot2)
library(tidyverse)
library(MASS)
library(haven)
library(data.table)
```

### Step 3.2 Import raw ANES data
We will be working with the DTA format of the raw ANES data, downloaded from [this page] (https://electionstudies.org/data-center/2016-time-series-study/)once you are registered *and* logged in you will see the download button. We will use the `read_dta` function from the `haven` package.
```{r}
anes_timeseries_2016 <- read_dta("~/Desktop/Spring2021-Project1-TommyZzk/data/anes_timeseries_2016_dta/anes_timeseries_2016.dta")
```

Some basic data summaries: there are `r nrow(anes_timeseries_2016)` respondents and `r ncol(anes_timeseries_2016)` variables.

Some answers to the questionnaires are not within my interest for reasons like Inap(Inapplicable), refuse to answer or miss the post-election interview and etc. So we will do some basic data leaning including convert data type and delete the negative numbers.
```{r}
anes_use <- anes_timeseries_2016%>%
  select(turnout = V162065x,
         vote = V161021a,
         race = V161310x,
         gender = V161342,
         party = V162279,
         state = V163001a,
         win = V161148)%>%
  mutate(turnout = as_factor(turnout),
         vote = as_factor(vote),
         race = as_factor(race),
         gender = as_factor(gender),
         party = as_factor(party),
         state = as_factor(state),
         win = as_factor(win))

save(anes_use,file="/Users/zy/Desktop/Spring2021-Project1-TommyZzk/output/data_use.RData")

str(anes_use$turnout)
```


```{r}
anes_use = anes_use%>%
  filter(turnout!="-2. Inap")
pie(table(anes_use$turnout))
```

```{r}
party_race_anes =anes_use %>%
  filter(race!="-2. Missing" & party!="-9. Refused" & party!="-7. No post data, deleted due to incomplete IW" & party!="-6. No post-election interview" & party!="-1. Inap")

levels(anes_use$party)

ggplot(party_race_anes)+
  geom_bar(aes(x=race, fill=party)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(title="Which party represents your views best?")+
scale_x_discrete(labels=c("1. White,non-Hispanic", "2. Black,non-Hispanic", "3. Asian,native Hawaiian or other Pacif Islr, \n non-Hispanic", "4. Native American or Alaska Native, \n non-Hispanic", "5. Hispanic", "6. Other non-Hispanic \n incl multiple races"))
```

```{r}
party_gender_anes <- anes_use%>%
  filter(party!="-9. Refused" & party!="-7. No post data, deleted due to incomplete IW" & party!="-6. No post-election interview" & party!="-1. Inap" & gender!="-9. Refused")
ggplot(party_gender_anes)+
geom_bar(aes(x=gender, fill=party))+
labs(title="Which party represents your views best?")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
race_anes = anes_use %>%
  filter(race!="-2. Missing")

ggplot(race_anes)+
  geom_bar(aes(x=race, fill=turnout)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(title="How did different racial groups participate in the election?")+
scale_x_discrete(labels=c("1. White,non-Hispanic", "2. Black,non-Hispanic", "3. Asian,native Hawaiian or other Pacif Islr, \n non-Hispanic", "4. Native American or Alaska Native, \n non-Hispanic", "5. Hispanic", "6. Other non-Hispanic \n incl multiple races"))+
scale_fill_discrete(name="race", breaks=c("0. Did not register and did not vote", "1. Registered but did not vote","2. Registered and voted","-2. Inap"))
```

```{r}
gender_anes = anes_use %>%
  filter(gender!="-9. Refused")

ggplot(gender_anes)+
  geom_bar(aes(x=gender, fill=turnout)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(title="How did different gender groups participate in the election?")
```

```{r}
president_race_anes <- anes_use%>%
  filter(vote!="-1. Inap, 2,-8,-9 in V161021 " & vote!="-8. Don't know (FTF only)" & vote!="-9. Refused" & race!="-2. Missing")

ggplot(president_race_anes)+
geom_bar(aes(x=race, fill=vote))+
labs(title="Who did different racial groups vote for president in the election?")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(title="In the Presidential primary or caucus, who did you vote for?")+
scale_x_discrete(labels=c("1. White,non-Hispanic", "2. Black,non-Hispanic", "3. Asian,native Hawaiian \n or other Pacif Islr, non-Hispanic", "4. Native American or Alaska Native, \n non-Hispanic", "5. Hispanic", "6. Other non-Hispanic \n incl multiple races"))
```

```{r}
president_gender_anes <- anes_use%>%
  filter(vote!="-1. Inap, 2,-8,-9 in V161021 " & vote!="-8. Don't know (FTF only)" & vote!="-9. Refused" &
gender!="-9. Refused")
ggplot(president_gender_anes)+
geom_bar(aes(x=gender, fill=vote))+
labs(title="In the Presidential primary or caucus, who did you vote for? ")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
```












